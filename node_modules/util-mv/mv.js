var FS = require('fs');
var PATH = require('path');
var mkdir = require('util-mkdir');
var rm = require('util-rm');

module.exports = mv;


/**
* @param	{string}	from		copy src
* @param	{string}	to			copy target
* @desc		like shell command mv
*/
function mv(from, to){
	if(!FS.existsSync(from)){
		if(FS.existsSync(to)){
			rm(to);
		}
		return;
	}
	if(FS.statSync(from).isDirectory()){
		// if is a directory, mkdir
		mkdir(to);
	}else{
		// if is a file, compare first
		if(FS.existsSync(to)){
			if(FS.readFileSync(from, 'utf-8') !== FS.readFileSync(to, 'utf-8')){ // if there were any other way to compare two files
				mvinner(from, to);
			}
		}else{
			mvinner(from, to);
		}
		
	}
	
	function mvinner(f, t){
		var dir = PATH.dirname(t);
		mkdir(dir);
		FS.writeFileSync(t, FS.readFileSync(f));
	}
}
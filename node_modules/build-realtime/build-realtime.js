// Load lib
var seajsConfig = require('alias-conf');
var synchronize = require('synchronize-files');

circle(function(){
	
// 功能一：生成seajs.conf前端配置文件
// 参数依次为：模板路径，生成文件路径，jsalias文件路径，cssalias文件路径，版本号
seajsConfig('E:/0_Project_data/[iPick]All/cms/front/conf/ipick.cms/__sea.conf.js',
			'E:/0_Project_data/[iPick]All/cms/front/conf/ipick.cms/sea.conf.js',
			'E:/0_Project_data/[iPick]All/cms/front/conf/ipick.cms/__jsalias.json',
			'E:/0_Project_data/[iPick]All/cms/front/conf/ipick.cms/__cssalias.json', new Date().getTime());
			
			
// 功能二：同步文件
synchronize.compareExclude( 'E:/0_Project_data/[iPick]All/cms/front/resource',
							'E:/0_Project_data/[iPick]All/cms/front/resource_dev');
synchronize.compareOnly('E:/0_Project_data/[iPick]All/cms/front/resource/page',
						'E:/0_Project_data/[iPick]All/cms/front/views');
	
})

function circle(callback, delay, limit){
    if(typeof callback !== 'function'){
        return;
    }

    // exec per 2 seconds
    delay ? null : delay = 1500;

    // exec total time
    limit ? null : limit = 60000;

    var s = new Date().getTime();
	var e;
    var i = setInterval(function(){
        callback();
		e = new Date().getTime();
        if(e - s > limit){
            clearInterval(i);
            console.log('Total:' + (e-s));
        }
    }, delay)
}
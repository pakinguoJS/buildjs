define("page/app/tsv/js/upload",["lib/cmd/jquery/2.0.3/jquery.js","lib/cmd/jquery-validate/1.13.0/jquery.validate.js","lib/cmd/jquery/form/3.50.0/jquery.form.js","page/widget/ivy_alert/js/ivy.alert.js","page/widget/file-upload/js/file-upload.js"],function(a){var b=a("lib/cmd/jquery/2.0.3/jquery.js");a("lib/cmd/jquery-validate/1.13.0/jquery.validate.js"),a("lib/cmd/jquery/form/3.50.0/jquery.form.js");var c=a("page/widget/ivy_alert/js/ivy.alert.js");a("page/widget/file-upload/js/file-upload.js"),b(".upload-btn").fileUpload({url:"/cms/index.php/upload/do_upload",file:{types:"*.tsv",typesDescription:"TSV Files",sizeLimit:"10 MB"}}).on("uploadsuccess",function(a){var d=b.parseJSON(a.body);if(d.ret)c(d.msg);else{var e=b(this).parents(".upload-form").first();e.find(".file").val(d.data.upload_path),e.find(".filename").val("File Name: "+d.data.upload_path.replace(/^.*\//,"")),c("TSV file uploaded successfully"),e.submit()}}).on("uploadstart",function(){c("Uploading...",{toggle:!0})}).on("error",function(a){var b={"QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED":"You can only upload one file at a time","QUEUE_ERROR.ZERO_BYTE_FILE":"The file is empty","QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT":"The file exceeded the maximum file size (2 MB)","QUEUE_ERROR.INVALID_FILETYPE":"The file format should be .tsv"}[a.error.type]||a.error.message;c(b)}),b(".upload-form").validate({errorPlacement:function(){}}),b(".upload-form").ajaxForm({beforeSubmit:function(){c("Importing...",{toggle:!0})},success:function(a,d,e,f){var g=f.find(".upload-result");if(a=b.parseJSON(a),a.ret){c("Import failed");var h=g.find(".samples").find(".alert.error").clone();h.find(".failed-time").html(a.data.time),g.append(h)}else if(c("Import completed"),0===a.errorcode){var h=g.find(".samples").find(".alert.fully-completed").clone();h.find(".completed-time").html(a.data.time),h.find(".time-spent").html(parseFloat(a.data.cost_time).toFixed(3)),h.find(".lines-total").html(a.data.total_line),h.find(".lines-imported").html(a.data.succ_line),h.find(".success-rate").html((a.data.succ_line/a.data.total_line*100).toFixed(1)+"%"),g.append(h)}else if(1===a.errorcode){var h=g.find(".samples").find(".alert.partially-completed-accepted").clone();h.find(".completed-time").html(a.data.time),h.find(".time-spent").html(parseFloat(a.data.cost_time).toFixed(3)),h.find(".lines-total").html(a.data.total_line),h.find(".lines-imported").html(a.data.succ_line),h.find(".success-rate").html((a.data.succ_line/a.data.total_line*100).toFixed(1)+"%"),h.find(".lines-deformed").html(a.data.warn_line),a.data.warn_line||h.find(".lines-deformed-message").addClass("hidden"),h.find(".lines-failed").html(a.data.total_line-a.data.succ_line),h.find(".token").html([a.data.token.city,a.data.token.file_type,a.data.token.id].join("-").toUpperCase()),g.append(h)}else if(2===a.errorcode){var h=g.find(".samples").find(".alert.partially-completed-rejected").clone();h.find(".completed-time").html(a.data.time),h.find(".time-spent").html(parseFloat(a.data.cost_time).toFixed(3)),h.find(".lines-total").html(a.data.total_line),h.find(".lines-imported").html(a.data.succ_line),h.find(".success-rate").html((a.data.succ_line/a.data.total_line*100).toFixed(1)+"%"),h.find(".lines-deformed").html(a.data.warn_line),a.data.warn_line||h.find(".lines-deformed-message").addClass("hidden"),h.find(".lines-failed").html(a.data.total_line-a.data.succ_line),h.find(".token").html([a.data.token.city,a.data.token.file_type,a.data.token.id].join("-").toUpperCase()),g.append(h)}}})}),define("page/widget/ivy_alert/js/ivy.alert",["page/widget/ivy_alert/css/ivy.alert.css","page/widget/ivy_alert/template/tpl.ivy.alert.js"],function(a,b,c){function d(a,b){h.find("#ivyAlertMain").text(a),b?null:b={},e(b),clearTimeout(g),b.toggle||(g=setTimeout(function(){f(),"function"==typeof b?b():"function"==typeof b.callback?b.callback():null},"number"==typeof b?b:b.duration?b.duration:i.duration))}function e(a){h.appendTo($("body")),setTimeout(function(){a.top?h.find("#ivyAlertMain").parent().css("top",a.top):h.find("#ivyAlertMain").parent().css("top",i.top),a.useMask?h.find("#ivyAlertMask").show():i.useMask?h.find("#ivyAlertMask").show():h.find("#ivyAlertMask").hide(),h.fadeIn(200)},20)}function f(){h.fadeOut(100,function(){h.detach()})}a("page/widget/ivy_alert/css/ivy.alert.css");var g,h=$(a("page/widget/ivy_alert/template/tpl.ivy.alert.js")),i={duration:1500,top:120,useMask:!0,callback:null};d.config=function(a){$.extend(i,a)},c.exports=d}),define("page/widget/ivy_alert/css/ivy.alert.css",[],function(){seajs.importStyle(".ivy-alert-wrap{position:fixed;top:0;left:0;width:100%;height:100%;z-index:1000;display:none}.ivy-alert{position:relative;margin:0 auto;min-height:50px;max-width:600px;text-align:center;top:120px}.ivy-alert-mask{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(255,255,255,.5);z-index:1001}.ivy-alert-main{position:relative;display:inline-block;font-size:14px;font-weight:700;color:#42484d;padding:16px 30px;background-color:#fff;border:1px solid #e15c4d;border-radius:3px;box-shadow:1px 1px 3px rgba(0,0,0,.35);z-index:1002}")}),define("page/widget/ivy_alert/template/tpl.ivy.alert",[],'<div class="ivy-alert-wrap">    <div id="ivyAlertMask" class="ivy-alert-mask"></div>    <div class="ivy-alert">        <p id="ivyAlertMain" class="ivy-alert-main"></p>    </div></div>'),define("page/widget/file-upload/js/file-upload",["lib/cmd/jquery/2.0.3/jquery.js","lib/cmd/bootstrap/3.2.0/js/bootstrap.min.js","lib/cmd/swf/swfupload.js","../css/file-upload.css"],function(a){var b=a("lib/cmd/jquery/2.0.3/jquery.js");a("lib/cmd/bootstrap/3.2.0/js/bootstrap.min.js");var c=a("lib/cmd/swf/swfupload.js");a("../css/file-upload.css"),b.fn.extend({fileUpload:function(a){return a=a||{},this.each(function(){if(!b(this).data("fileUpload")){b(this).data("fileUpload",{});var d=b(this),e=b(this).data("fileUpload");e.swfId="swfupload-"+Math.random(),e.url=a.url||b(this).attr("data-url")||"",e.params=a.params||b(this).attr("data-params")||{},e.file={types:a.file.types||b(this).attr("data-file-types")||"*.*",typesDescription:a.file.typesDescription||b(this).attr("data-file-types-description")||"Files",sizeLimit:a.file.sizeLimit||b(this).attr("data-file-size-limit")||"2 MB"},e.errorCodes={QUEUE_ERROR:c.QUEUE_ERROR,UPLOAD_ERROR:c.UPLOAD_ERROR},b(this).addClass("file-upload").append(b("<span></span>").attr("id",e.swfId));{new c({upload_url:e.url,flash_url:"/cms/resource/lib/cmd/swf/swfupload.swf",file_post_name:"Filedata",post_params:e.params,use_query_string:!1,requeue_on_error:!1,http_success:[201,202],assume_success_timeout:0,file_types:e.file.types,file_types_description:e.file.typesDescription,file_size_limit:e.file.sizeLimit,file_upload_limit:0,file_queue_limit:0,debug:!1,prevent_swf_caching:!1,preserve_relative_urls:!1,button_placeholder_id:e.swfId,button_image_url:"javascript:void(0)",button_width:1e3,button_height:300,button_text:"",button_text_style:"",button_text_left_padding:0,button_text_top_padding:0,button_action:c.BUTTON_ACTION.SELECT_FILES,button_disabled:!1,button_cursor:c.CURSOR.HAND,button_window_mode:c.WINDOW_MODE.TRANSPARENT,swfupload_loaded_handler:function(){var a=b.Event("uploadready");d.trigger(a)},file_dialog_start_handler:function(){},file_queued_handler:function(){this.startUpload()},file_queue_error_handler:function(a,e,f){var g=b.Event("error");g.file=a;var h={};h[c.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED]="QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED",h[c.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT]="QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT",h[c.QUEUE_ERROR.ZERO_BYTE_FILE]="QUEUE_ERROR.ZERO_BYTE_FILE",h[c.QUEUE_ERROR.INVALID_FILETYPE]="QUEUE_ERROR.INVALID_FILETYPE",h[c.UPLOAD_ERROR.HTTP_ERROR]="UPLOAD_ERROR.HTTP_ERROR",h[c.UPLOAD_ERROR.MISSING_UPLOAD_URL]="UPLOAD_ERROR.MISSING_UPLOAD_URL",h[c.UPLOAD_ERROR.IO_ERROR]="UPLOAD_ERROR.IO_ERROR",h[c.UPLOAD_ERROR.SECURITY_ERROR]="UPLOAD_ERROR.SECURITY_ERROR",h[c.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED]="UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED",h[c.UPLOAD_ERROR.UPLOAD_FAILED]="UPLOAD_ERROR.UPLOAD_FAILED",h[c.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND]="UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND",h[c.UPLOAD_ERROR.FILE_VALIDATION_FAILED]="UPLOAD_ERROR.FILE_VALIDATION_FAILED",h[c.UPLOAD_ERROR.FILE_CANCELLED]="UPLOAD_ERROR.FILE_CANCELLED",h[c.UPLOAD_ERROR.UPLOAD_STOPPED]="UPLOAD_ERROR.UPLOAD_STOPPED",g.error={type:h[e]||"UNKNOWN",message:f},d.trigger(g)},file_dialog_complete_handler:function(){},upload_start_handler:function(a){var c=b.Event("uploadstart");c.file=a,d.trigger(c)},upload_progress_handler:function(a,c,e){var f=b.Event("uploadprogress");f.file=a,f.uploaded=c,f.total=e,d.trigger(f)},upload_error_handler:function(a,c,e){var f=b.Event("error");f.file=a,f.errorCode=c,f.errorMessage=e,d.trigger(f)},upload_success_handler:function(a,c,e){var f=b.Event("uploadsuccess");f.file=a,f.body=c,f.response=e,d.trigger(f)},upload_complete_handler:function(a){var c=b.Event("uploadcomplete");c.file=a,d.trigger(c)},debug_handler:function(a){this.settings.debug&&console.log(a)},custom_settings:{}})}}}),this}})}),define("page/widget/file-upload/css/file-upload.css",[],function(){seajs.importStyle(".file-upload{position:relative;overflow:hidden}.file-upload .swfupload-wrap{display:block;position:absolute;left:0;top:0;right:0;bottom:0}")});
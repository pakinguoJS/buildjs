var FS = require('fs');
var transport	= require('cmd-transport');
var uglify		= require('cmd-uglify');
var config 		= require('./CONFIG.json');


// 读取配置
var alias		= require(config.alias);
var ignore		= require(config.ignore);
var gruntjs		= config.gruntjs;


/**
 * 执行流程：
 * 1、copy：源项目文件
 * 2、transport：覆盖掉cmd模块
 * 3、uglify：合并压缩，以单一模块为单位（模块包括其依赖链）
 */
var s = new Date().getTime();

transport(config.transportSrc, config.transportDest, alias, gruntjs, function(){
	uglify(config.uglifySrc, config.uglifyBase, ignore, gruntjs, function(){
		console.log("=============Finish: " + (new Date().getTime() - s) + " ms==============");
	})
});